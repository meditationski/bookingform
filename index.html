<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ski School Calculator</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #222529; font-family: 'Inter', sans-serif; color: #858e96; padding: 15px; min-height: 100vh; }
    .calculator-container { max-width: 100%; margin: 0 auto; background: #222529; border-radius: 12px; padding: 20px; }
    .form-header { text-align: center; margin-bottom: 25px; }
    .form-title { font-size: 24px; font-weight: 700; color: #ffffff; margin-bottom: 8px; line-height: 1.2; }
    .form-group { margin-bottom: 20px; }
    .section-title { font-size: 14px; font-weight: 600; color: #ffffff; margin-bottom: 8px; }
    .tabs { display: flex; background: #2a2e33; border-radius: 8px; padding: 3px; gap: 3px; }
    .tab { flex: 1; padding: 10px; text-align: center; background: transparent; border: none; color: #858e96; font-weight: 600; border-radius: 6px; cursor: pointer; font-size: 14px; }
    .tab.active { background: #00A3FF; color: #ffffff; }
    select, .date-input { width: 100%; padding: 12px; border: 1px solid #3a3f45; border-radius: 8px; font-size: 14px; background: #2a2e33; color: #ffffff; }
    .slider-container { margin-top: 8px; }
    .slider-value { text-align: center; font-weight: 600; color: #00A3FF; font-size: 14px; margin: 6px 0; }
    input[type="range"] { width: 100%; height: 6px; background: #3a3f45; border-radius: 3px; margin: 10px 0; }
    .slider-labels { display: flex; justify-content: space-between; font-size: 10px; color: #858e96; }
    .time-selection { background: #2a2e33; border-radius: 8px; padding: 15px; border: 1px solid #3a3f45; }
    .time-slots { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
    .time-slot { padding: 10px; background: #3a3f45; border: none; border-radius: 6px; color: #ffffff; font-size: 13px; cursor: pointer; text-align: center; }
    .time-slot.selected { background: #00A3FF; }
    .time-slot.disabled { opacity: 0.3; cursor: not-allowed; }
    .selected-info { text-align: center; margin-top: 12px; font-size: 13px; color: #00A3FF; font-weight: 600; }
    .price-display { background: #254d63; color: #ffffff; padding: 20px; border-radius: 12px; margin-top: 20px; }
    .price-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 15px; }
    .total-price { font-size: 28px; font-weight: 700; }
    .discount-info { text-align: center; margin-top: 12px; font-size: 13px; color: #00A3FF; font-weight: 600; }
    
    /* Убираем скролл для iframe */
    html, body { overflow: hidden; }
</style>
</head>
<body>
    <div class="calculator-container">
        <div class="form-header"><div class="form-title">Calculate Your Lesson</div></div>
        
        <div class="form-group">
            <div class="tabs">
                <div class="tab active" data-sport="ski">Ski</div>
                <div class="tab" data-sport="snowboard">Snowboard</div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="section-title">Lesson Duration</div>
            <select id="duration">
                <option value="2">2 hours lesson - $100</option>
                <option value="3">3 hours lesson - $140</option>
                <option value="full">Full day lesson - $250</option>
            </select>
        </div>
        
        <div class="form-group">
            <div class="section-title">Number of Participants</div>
            <div class="slider-container">
                <div class="slider-value" id="participantsValue">1 person</div>
                <input type="range" id="participants" min="1" max="5" value="1" step="1">
                <div class="slider-labels">
                    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="section-title">Number of Days</div>
            <div class="slider-container">
                <div class="slider-value" id="daysValue">1 day</div>
                <input type="range" id="days" min="1" max="10" value="1" step="1">
                <div class="slider-labels">
                    <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                    <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <div class="section-title">Start Date</div>
            <input type="date" class="date-input" id="startDate" min="2025-12-15" max="2026-04-30">
        </div>
        
        <div class="form-group">
            <div class="section-title">Start Time</div>
            <div class="time-selection">
                <div class="time-slots" id="timeSlots"></div>
            </div>
            <div class="selected-info" id="selectedDateTime">No date selected</div>
        </div>
        
        <div class="price-display">
            <div class="price-row"><span>Total amount:</span><span id="totalPrice">$100</span></div>
            <div class="price-row"><span>20% deposit:</span><span id="depositPrice">$20</span></div>
            <div class="price-row"><span>Remaining balance:</span><span id="remainingPrice">$80</span></div>
            <div id="discountInfo" class="discount-info"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const prices = {'2': 100, '3': 140, 'full': 250};
            const tabs = document.querySelectorAll('.tab');
            const durationSelect = document.getElementById('duration');
            const participantsSlider = document.getElementById('participants');
            const participantsValue = document.getElementById('participantsValue');
            const daysSlider = document.getElementById('days');
            const daysValue = document.getElementById('daysValue');
            const startDateInput = document.getElementById('startDate');
            const timeSlotsEl = document.getElementById('timeSlots');
            const selectedDateTimeEl = document.getElementById('selectedDateTime');
            const totalPrice = document.getElementById('totalPrice');
            const depositPrice = document.getElementById('depositPrice');
            const remainingPrice = document.getElementById('remainingPrice');
            const discountInfo = document.getElementById('discountInfo');
            
            let selectedTime = null;

            // Set min date to today or Dec 15, 2025
            const today = new Date().toISOString().split('T')[0];
            const minDate = "2025-12-15";
            startDateInput.min = today > minDate ? today : minDate;
            startDateInput.max = "2026-04-30";

            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    calculatePrice();
                });
            });

            participantsSlider.addEventListener('input', function() {
                participantsValue.textContent = this.value + (this.value == 1 ? ' person' : ' people');
                calculatePrice();
            });

            daysSlider.addEventListener('input', function() {
                daysValue.textContent = this.value + (this.value == 1 ? ' day' : ' days');
                calculatePrice();
            });

            durationSelect.addEventListener('change', function() {
                calculatePrice();
                updateTimeSlots();
            });

            startDateInput.addEventListener('change', function() {
                selectedTime = null;
                updateTimeSlots();
                updateSelectedDateTime();
                calculatePrice();
            });

            function updateTimeSlots() {
                timeSlotsEl.innerHTML = '';
                if (!startDateInput.value) {
                    timeSlotsEl.innerHTML = '<div class="time-slot disabled">Select date first</div>';
                    return;
                }

                const duration = durationSelect.value === 'full' ? 8 : parseInt(durationSelect.value);
                for (let hour = 10; hour <= 17 - duration; hour++) {
                    const timeSlot = document.createElement('button');
                    const timeString = `${hour}:00`;
                    timeSlot.className = 'time-slot';
                    timeSlot.textContent = timeString;
                    if (selectedTime === timeString) timeSlot.classList.add('selected');
                    
                    timeSlot.addEventListener('click', function() {
                        document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                        selectedTime = timeString;
                        this.classList.add('selected');
                        updateSelectedDateTime();
                        calculatePrice();
                    });
                    
                    timeSlotsEl.appendChild(timeSlot);
                }
            }

            function updateSelectedDateTime() {
                if (startDateInput.value && selectedTime) {
                    const date = new Date(startDateInput.value);
                    const dateStr = date.toLocaleDateString('en-US', {weekday: 'short', month: 'short', day: 'numeric'});
                    selectedDateTimeEl.textContent = `${dateStr} at ${selectedTime}`;
                } else if (startDateInput.value) {
                    const date = new Date(startDateInput.value);
                    const dateStr = date.toLocaleDateString('en-US', {weekday: 'short', month: 'short', day: 'numeric'});
                    selectedDateTimeEl.textContent = `${dateStr} - Select time`;
                } else {
                    selectedDateTimeEl.textContent = 'No date selected';
                }
            }

            function calculatePrice() {
                const duration = durationSelect.value;
                const participants = parseInt(participantsSlider.value);
                const days = parseInt(daysSlider.value);
                
                let basePrice = prices[duration];
                const additionalPrice = (participants - 1) * 40;
                const pricePerDay = basePrice + additionalPrice;
                
                let total = 0;
                let maxDiscount = 0;
                
                for (let day = 1; day <= days; day++) {
                    let discount = 0;
                    if (day >= 8) discount = 0.20;
                    else if (day >= 6) discount = 0.15;
                    else if (day >= 4) discount = 0.10;
                    
                    total += pricePerDay * (1 - discount);
                    if (discount > maxDiscount) maxDiscount = discount;
                }
                
                total = Math.round(total);
                const deposit = Math.round(total * 0.20);
                const remaining = total - deposit;
                
                totalPrice.textContent = `$${total}`;
                depositPrice.textContent = `$${deposit}`;
                remainingPrice.textContent = `$${remaining}`;
                
                discountInfo.textContent = maxDiscount > 0 ? 
                    `You save ${maxDiscount * 100}% on days ${maxDiscount === 0.20 ? '8+' : maxDiscount === 0.15 ? '6-7' : '4-5'}` : '';
            }

            updateTimeSlots();
            calculatePrice();
        });
    </script>
</body>
</html>
